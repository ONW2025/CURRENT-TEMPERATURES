<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Weather Information</title>
  <!-- Include html2canvas library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Overpass:wght@900&display=swap');

    /* Use imported font for everything */
    * {
      font-family: 'Overpass Black', sans-serif !important;
    }

    body {
      margin: 0;
      background: #000;
      overflow: auto;
    }

    /* The #map-container is fixed at our base resolution (e.g., 1920Ã—1080)
       and then scaled to 85% of the viewport width */
    #map-container {
      position: relative;
      width: 1920px;
      height: 1080px;
      margin: 0 auto;
      transform: scale(calc(85vw / 1920));
      transform-origin: top center;
    }

    /* The map image fills the container */
    #map-image {
      width: 100%;
      height: 100%;
      display: block;
    }

    /* Overlay sits over the map image */
    #overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    /* Weather info container and timestamp inside the overlay */
    #weather-info-container {
      position: relative;
      width: 100%;
      height: 100%;
      pointer-events: auto;
    }

    /* Adjust timestamp positioning using percentages */
    #timestamp {
      position: absolute;
      bottom: 5%;
      left: 5%;
      font-family: 'Overpass', sans-serif;
      font-size: 1.5em;
      color: white;
      text-shadow: 0 0 10px rgba(0,0,0,0.8);
      background-color: transparent;
      padding: 10px 20px;
      border-radius: 5px;
      text-align: left;
      pointer-events: auto;
    }

    /* --- Weather card styling --- */
    .weather-card {
      font-size: 1.5em;
      text-shadow: 3px 1px 1px rgba(0,0,0,0.7);
      color: white;
      padding: 20px;
      margin: 10px;
      text-align: center;
      background: rgba(0,0,0,0);
      border-radius: 10px;
      position: absolute;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      width: 200px;
      height: auto;
    }

    .station-name-card {
      font-size: 1em;
      text-shadow: 1px 1px 10px rgba(0,0,0,0.8), 1px 10px 10px rgba(0,0,0,0.9);
      margin-bottom: 10px;
      position: relative;
      overflow: visible;
    }
    .station-text {
      position: relative;
      z-index: 1;
    }
    .station-name-card .edit-temp-btn,
    .station-name-card .temp-edit-input {
      display: none;
    }
    .station-name-card:hover .edit-temp-btn,
    .station-name-card:hover .temp-edit-input {
      display: inline-block;
    }
    .station-name-card .edit-temp-btn {
      position: absolute;
      top: 0;
      right: 0;
      z-index: 2;
      background-color: rgba(255,255,255,0.3);
      border: 1px solid white;
      color: white;
      cursor: pointer;
      padding: 3px 6px;
      font-size: 0.8em;
    }
    .station-name-card .temp-edit-input {
      position: absolute;
      top: 100%;
      right: 0;
      z-index: 2;
      margin-top: 2px;
      padding: 5px;
      border: 1px solid #ccc;
      font-size: 0.9em;
      text-align: center;
      width: 60px;
    }
    .temperature-card {
      font-family: 'Roboto', sans-serif;
      font-size: 2em;
      text-shadow: 0 0 10px rgba(0,0,0,0.8), 0 0 10px rgba(0,0,0,0.9);
      color: white;
      margin-top: 25px;
      position: relative;
    }
    .temperature-card .degree-symbol {
      font-size: 0.8em;
      vertical-align: 8px;
      margin-left: -12px;
      position: relative;
    }
    .rename-input {
      background: rgba(255,255,255,0.7);
      border: none;
      padding: 5px;
      margin-top: 10px;
      width: 100%;
      font-size: 1em;
      text-align: center;
    }
  </style>
</head>
<body>

  <!-- The fixed-dimension container that holds the entire project -->
  <div id="map-container">
    <!-- Added crossorigin="anonymous" for proper CORS handling -->
    <img id="map-image" src="blank map tyler (1).png" alt="Map" crossorigin="anonymous" />
    <div id="overlay">
      <div id="weather-info-container"></div>
      <div id="timestamp"></div>
    </div>
  </div>

  <script>
    (function() {
      // --- [Your existing project code would be here (API calls, draggable elements, etc.)] ---
      // For brevity, assume all your weather info, draggable elements, etc. load as before.

      // --- RIGHT-CLICK IMAGE CAPTURE CODE ---
      const mapContainer = document.getElementById('map-container');
      // Attach the contextmenu event in capture phase
      mapContainer.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        console.log("Right-click event captured");
        // Save the current transform and temporarily remove it for capture
        const originalTransform = mapContainer.style.transform;
        mapContainer.style.transform = 'none';
        html2canvas(mapContainer, { useCORS: true, scale: 1 })
          .then(function(canvas) {
            const dataURL = canvas.toDataURL('image/png');
            // Create an overlay for the captured image
            const overlayDiv = document.createElement('div');
            overlayDiv.style.position = 'fixed';
            overlayDiv.style.top = 0;
            overlayDiv.style.left = 0;
            overlayDiv.style.width = '100%';
            overlayDiv.style.height = '100%';
            overlayDiv.style.backgroundColor = 'rgba(0,0,0,0.85)';
            overlayDiv.style.display = 'flex';
            overlayDiv.style.alignItems = 'center';
            overlayDiv.style.justifyContent = 'center';
            overlayDiv.style.zIndex = 9999;
            // Clicking outside the image closes the overlay
            overlayDiv.addEventListener('click', function() {
              document.body.removeChild(overlayDiv);
            });
            const img = document.createElement('img');
            img.src = dataURL;
            img.alt = 'Captured Image';
            overlayDiv.appendChild(img);
            document.body.appendChild(overlayDiv);
          })
          .catch(function(error) {
            console.error("Error capturing container:", error);
          })
          .finally(function() {
            // Always restore the transform
            mapContainer.style.transform = originalTransform;
          });
      }, true);
    })();
  </script>
  
  <!-- Tooltip element -->
  <div id="customTooltip"></div>
  
</body>
</html>
